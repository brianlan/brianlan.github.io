<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>My Tour of Go | Rambo的博客</title><link rel="stylesheet" type="text/css" href="/css/normalize.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/pure-min.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">My Tour of Go</h1><a id="logo" href="/.">Rambo的博客</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="icon-home"> Home</i></a><a href="/archives/"><i class="icon-archive"> Archive</i></a><a href="/about/"><i class="icon-about"> About</i></a><a href="/atom.xml"><i class="icon-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">My Tour of Go</h1><div class="post-meta">2016-08-20</div><div class="post-content"><h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><h3 id="package"><a href="#package" class="headerlink" title="package"></a>package</h3><ul>
<li>Go’s package control is similar to python, but it has convention, </li>
<li>package name is all writen in lower case</li>
<li>referring to some function or vars from a package, only the exported names of this package is visible from the outside. This is similar to private / public access of defined elements.</li>
</ul>
<h3 id="function"><a href="#function" class="headerlink" title="function"></a>function</h3><ul>
<li>function name is starting with Capital letter.</li>
<li>type comes after variable name when passing params to a function</li>
<li>use <strong>func</strong> keyword to define a function</li>
<li>if two parameters have the same type, we can omit former ones and keep only the last one. It’s also reflect the thinking behind the design of Go - simpliy the language expression.</li>
<li>Go can return multiple results in a function, similar to python. Is it an implicit tuple type?</li>
</ul>
<h3 id="asignment"><a href="#asignment" class="headerlink" title="asignment"></a>asignment</h3><ul>
<li>:= is initialize operator (use this as much as possible)</li>
<li>= is assign operator</li>
<li>can use <strong>var</strong> to do the declaration, we can also put an assign altogether.</li>
</ul>
<h3 id="type_cast"><a href="#type_cast" class="headerlink" title="type cast"></a>type cast</h3><ul>
<li>should be explicit</li>
</ul>
<h3 id="named_return"><a href="#named_return" class="headerlink" title="named return"></a>named return</h3><ul>
<li>there seems no big benefit to use named return (naked return)</li>
</ul>
<h3 id="const"><a href="#const" class="headerlink" title="const"></a>const</h3><ul>
<li>Numeric constants are high-precision values. An untyped constant takes the type needed by its context.</li>
</ul>
<h3 id="factored"><a href="#factored" class="headerlink" title="factored"></a>factored</h3><ul>
<li>can reduce some duplicated coding, for example, var (a int = 1, b float = 0.1) and import (“fmt”, “match/cmplx”)</li>
</ul>
<h3 id="import"><a href="#import" class="headerlink" title="import"></a>import</h3><ul>
<li>factored import: use parenthesis and write each imported packaged in separated lines without comma or semi-colon</li>
</ul>
<h3 id="loop"><a href="#loop" class="headerlink" title="loop"></a>loop</h3><ul>
<li>the only keyword for loop in Go is <strong>for</strong>, can use <strong>for</strong> to do the thing that <strong>while</strong> used to do. (indeed, most of the <strong>while</strong> use case can be replaced by <strong>for</strong>)</li>
<li>can not omit {} when using <strong>for</strong>, because Go don’t use newline to differentiate code blocks like python does</li>
<li>infinite loop := <strong>for</strong> {}</li>
</ul>
<h3 id="defer"><a href="#defer" class="headerlink" title="defer"></a>defer</h3><ul>
<li>seems like defer is following a push / pop stack mechanism. </li>
<li>it’s a quite interesting feature that does the flow control thing. it’s special by comparing it with other programming languages.</li>
<li>more details <a href="https://blog.golang.org/defer-panic-and-recover" target="_blank" rel="external">Defer, Panic, and Recover</a></li>
</ul>
<h3 id="panic__26amp_3B_recover"><a href="#panic__26amp_3B_recover" class="headerlink" title="panic &amp; recover"></a>panic &amp; recover</h3><ul>
<li>seems like panic and recover are doing the <strong>Error Handling</strong> tasks. </li>
<li>panic can be propagated to outer callers and recover can catch a panic and resume the program to a normal status from a panicking status.</li>
</ul>
<h3 id="nil"><a href="#nil" class="headerlink" title="nil"></a>nil</h3><ul>
<li>NULL</li>
<li>use == to test equivalence</li>
</ul>
<h3 id="struct"><a href="#struct" class="headerlink" title="struct"></a>struct</h3><ul>
<li>use {} to initialize a defined struct type, e.g.<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v := Vertex&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="array"><a href="#array" class="headerlink" title="array"></a>array</h3><ul>
<li>arrays cannot be resized</li>
</ul>
<h3 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h3><ul>
<li><p>slice is a dynamically-sized array, e.g. </p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s []<span class="typename">int</span> = primes[<span class="number">1</span>:<span class="number">4</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>slices are like references to arrays. A slice does not store any data, it just describes a section of an underlying array.</p>
</li>
<li>when talking about the index, the slice in golang is just the same as in python.</li>
<li>slice has <em>len</em> and <em>cap</em>. </li>
<li>empty slice is <em>nil</em></li>
<li>The start and end indices of a slice expression are optional; they default to zero and the slice’s length (NOTE: not cap) respectively. </li>
<li>when moving slice ptr away from the head of the original underlying array, it’ll never found back the head (but if the underlying array is defined before the slice created, you can find it back by referring to the array with var naem). this is tied to the internal mechanism of slice, it’s a ptr a length element and a cap element. </li>
</ul>
<h3 id="examples_for_array__26amp_3B_slice"><a href="#examples_for_array__26amp_3B_slice" class="headerlink" title="examples for array &amp; slice"></a>examples for array &amp; slice</h3><ul>
<li>in below example, b is an array with type [2]string (2 is calculated out from the literal, and then fixed to as the array size). While c is a slice, even the literals contains 2 elements, but the type is still dynamically sized as []string.<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b := [...]<span class="typename">string</span>&#123;<span class="string">"Penn"</span>, <span class="string">"Teller"</span>&#125;</span><br><span class="line">c := []<span class="typename">string</span>&#123;<span class="string">"Brian"</span>, <span class="string">"Ryan"</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="range"><a href="#range" class="headerlink" title="range"></a>range</h3><ul>
<li><em>for i, v := range mylist</em> is similar to python’s <em>for idx, val in enumerate(mylist)</em></li>
<li>the returning of range: the first is the index, and the second is a copy of the element at that index.</li>
</ul>
<h3 id="make"><a href="#make" class="headerlink" title="make"></a>make</h3><ul>
<li>make is an initialization function that can be used to created empty array or map that are ready to use.</li>
</ul>
<h3 id="variant_length_params"><a href="#variant_length_params" class="headerlink" title="variant length params"></a>variant length params</h3><ul>
<li>…T</li>
</ul>
<h3 id="Literals"><a href="#Literals" class="headerlink" title="Literals"></a>Literals</h3><ul>
<li>no matter it is a struct literals, array literals or slice literals, it’s like providing the content values when declaring it.</li>
</ul>
<h3 id="if"><a href="#if" class="headerlink" title="if"></a>if</h3><ul>
<li>can not omit {} when using <strong>if</strong> and <strong>else</strong>.</li>
<li>statement can be placed before if condition to do some preparation</li>
</ul>
<h3 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h3><ul>
<li>statement can be placed before the variable under switch test</li>
<li>no need to write break in each branch.</li>
<li>we can leave the switch condition empty, it’s a easy way to do long if-then-else chains.</li>
</ul>
<h3 id="built-ins"><a href="#built-ins" class="headerlink" title="built-ins"></a>built-ins</h3><ul>
<li>fmt is similar to c’s printf and scanf. </li>
<li>in fmt.Printf(), %f, %e and %g are all formatting float numbers. But %f formats data as decimal but no exponent; %e outputs scientific notations; while %g is a balancer between %f and %e: %e for large exponents, %f otherwise.</li>
<li>%T outputs the type of a var, %v prints the default format of a var’s value.</li>
<li>%q is a double-quoted string safely escaped with Go syntax, with this we do not need the python-style ‘“{}”‘</li>
<li>fmt.Println accepts any number of params, and output them using ‘ ‘ as separator.</li>
</ul>
<h3 id="copy"><a href="#copy" class="headerlink" title="copy"></a>copy</h3><ul>
<li>like memcopy in C, Go has a copy function:<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="built_in">copy</span>(dst, src []T) <span class="typename">int</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Declaration"><a href="#Declaration" class="headerlink" title="Declaration"></a>Declaration</h3><ul>
<li>easier to understand than C family style. it’s a improvement over traditional styles, it shows the evolution of programming languages in recent years, we can see more and more languages use the way that Go uses.</li>
</ul>
<h3 id="rune"><a href="#rune" class="headerlink" title="rune"></a>rune</h3><ul>
<li>interesting name</li>
<li>it’s unicode code point.</li>
</ul>
<h3 id="zero_value"><a href="#zero_value" class="headerlink" title="zero value"></a>zero value</h3><ul>
<li>similar to C, 0 for numeric types, false for boolean types, “” for string.</li>
</ul>
<h3 id="Closure"><a href="#Closure" class="headerlink" title="Closure"></a>Closure</h3><blockquote>
<p>A closure is a function value that references variables from outside its body. The function may access and assign to the referenced variables; in this sense the function is “bound” to the variables.</p>
</blockquote>
<p>below two examples shows what is a closure.</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Example 1: the adder function returns a closure. Each closure is bound to its own sum variable.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> adder() <span class="keyword">func</span>(<span class="typename">int</span>) <span class="typename">int</span> &#123;</span><br><span class="line">    sum := <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">func</span>(x <span class="typename">int</span>) <span class="typename">int</span> &#123;</span><br><span class="line">        sum += x</span><br><span class="line">        <span class="keyword">return</span> sum</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">    pos, neg := adder(), adder()</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">        fmt.Println(</span><br><span class="line">            pos(i),</span><br><span class="line">            neg(-<span class="number">2</span>*i),</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Example 2:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> fibonacci() <span class="keyword">func</span>() <span class="typename">int</span> &#123;</span><br><span class="line">    i, j := <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">func</span>() <span class="typename">int</span> &#123;</span><br><span class="line">        r := i</span><br><span class="line">        i = j</span><br><span class="line">        j += r</span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">    f := fibonacci()</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">        fmt.Println(f())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h3><ul>
<li>Go does not have classes. However, you can define methods on types. methods are defined outside of the type struct define. </li>
<li>receiver (v Vertex) defined in func (v Vertex) Abs() float64 is similar to the member function definition in C++, that is float64 Vertex::Abs()</li>
<li>you can define methods to any type you want (not only struct type), for example float. But be careful, you can only declare a method with a receiver whose type is defined in the same package as the method.</li>
<li>defining methods for normal type receivers and pointer receivers will have different access level. the former one only has read access while the latter one has write access, it can modify the values to which the receiver points. No matter which way you’re using to define the method, both the value and pointer of this type can call this method, but the access follows how you define the receiver as describe above.</li>
<li>The leading-end of the relationship between a method and a type is different in Go. It’s more like function is an outsider (a caller), and the object of the type is the parameter that passed to it.</li>
</ul>
<h3 id="interface"><a href="#interface" class="headerlink" title="interface"></a>interface</h3><ul>
<li>An interface can either be a normal type or a pointer type.</li>
<li>interface is also a type, that’s why when declaring it use type I interface {}</li>
<li>empty interface may hold values of any type, it’s similar to C’s void* type.</li>
<li>type switch is similar to pattern matching in Scala, it’s to provide different type assertions to expect the passed-in interface can be transformed to an expected concrete value.</li>
<li><p>define a String() method to let Stringer interface to do printing. It’s like defining toString() method in Java.</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> (v YourType) String() <span class="typename">string</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> fmt.Sprintf(<span class="string">"something"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>if the receiver of an abstract method is defined using pointer, then when calling the interface’s method, it can only be successful when the interface is a pointer.</p>
</li>
</ul>
<h3 id="goroutine"><a href="#goroutine" class="headerlink" title="goroutine"></a>goroutine</h3><ul>
<li>goroutine does not map to OS thread, it’s controled by Go runtime on segmented stack, so the number of goroutines can be much larger than Java has, namely multiple goroutines map to 1 OS thread. So, set GOMAXPROCS to the number of cores on your system is a good way to maximize potential parellelism.</li>
<li>main function is an implicit goroutine, like in some other languages, the main function is an implicit thread.</li>
</ul>
<h3 id="channel"><a href="#channel" class="headerlink" title="channel"></a>channel</h3><ul>
<li>although ‘goroutine’ looks similar to ‘coroutine’ in terms of the spelling, but functionally, what channel does is more similar to coroutine. like coroutine, channel is used to do communication (send and receive message, make one party wait until the other party does some action). </li>
<li><blockquote>
<p>Normally channels are synchronous; both sides of the channel will wait until the other side is ready. A buffered channel is asynchronous; sending or receiving a message will not wait unless the channel is already full.</p>
</blockquote>
</li>
</ul>
<h2 id="Questions"><a href="#Questions" class="headerlink" title="Questions"></a>Questions</h2><ul>
<li>Why Go make complex a built-in type? to serve what scenario?</li>
<li>[<font color="green">answered</font>] Why constants cannot be declared using the := syntax? <ul>
<li>Because := is a way to omit <strong>var</strong>. but when define a constant, we use keyword <strong>const</strong>, which means it’s not a <strong>var</strong>. So := can not be used here.</li>
</ul>
</li>
<li>[<font color="green">answered</font>] what’s the underlying implementation of creating a slice literals? Is there an array created first, and then slicing a full of it?<ul>
<li>When called, make allocates an array and returns a slice that refers to that array.</li>
</ul>
</li>
<li>[<font color="green">answered</font>] what does <strong>cap</strong> do in a slice? why do we need to use <strong>make</strong> to create a zeroed array and a slice? (<a href="https://blog.golang.org/go-slices-usage-and-internals" target="_blank" rel="external">Go Slices: usage and internals</a>)</li>
<li>why Go use panic and recover to do error handling? is it related to async programming? </li>
<li>What would it be like when walking through a bi-tree, and launching goroutines recurrently in the duration?</li>
<li><del>If multiple goroutines are mapped to the same thread, does it mean the execution results would always be the same no matter how much times we run this code? (due to there’s only 1 underlying thread, so the actual cpu resource follows a non-random pattern?)</del></li>
<li></li>
</ul>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p>1 <a href="https://tour.golang.org/concurrency/8" target="_blank" rel="external">https://tour.golang.org/concurrency/8</a><br>1 <a href="https://www.golang-book.com/books/intro/10" target="_blank" rel="external">https://www.golang-book.com/books/intro/10</a><br>1 <a href="https://gobyexample.com/channels" target="_blank" rel="external">https://gobyexample.com/channels</a></p>
</div><div class="tags"><a href="/tags/Go/">Go</a><a href="/tags/Programming/">Programming</a></div><div class="post-nav"><a href="/2016/07/30/select/" class="next">select<i class="icon-next"></i></a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search" class="search-form-input"/><input type="hidden" name="sitesearch" value="http://www.lanrongyi.com"/></form></div><div class="widget"><div class="widget-title">Categories</div></div><div class="widget"><div class="widget-title">Tags</div><div class="tagcloud"><a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/select/" style="font-size: 15px;">select</a> <a href="/tags/Programming/" style="font-size: 15px;">Programming</a> <a href="/tags/Go/" style="font-size: 15px;">Go</a> <a href="/tags/OOP/" style="font-size: 15px;">OOP</a></div></div><div class="widget"><div class="widget-title">Recent</div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/08/20/go-tour/">My Tour of Go</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/30/select/">select</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/31/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/31/Python-OOP-Thinking/">Python OOP Thinking</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/30/My-New-Post/">测试文章</a></li></ul></div><div class="widget"><div class="widget-title">Blogroll</div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div></div><div id="footer">© <a href="/." rel="nofollow">Rambo的博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/jquery.min.js?v=0.0.0"></script><script type="text/javascript" src="/js/totop.js?v=0.0.0"></script><script type="text/javascript" src="/js/fancybox.pack.js?v=0.0.0"></script><script type="text/javascript" src="/js/jquery.fancybox.js?v=0.0.0"></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>